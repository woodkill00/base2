# Traefik Configuration File (static config)
entryPoints:
  web:
    address: ":${TRAEFIK_PORT}"
    http:
      redirections:
        entryPoint:
          to: websecure

  websecure:
    address: ":443"

  traefik:
    address: ":${TRAEFIK_API_PORT}"

api:
  dashboard: true
  insecure: false
  debug: ${TRAEFIK_API_DEBUG}

ping: {}

log:
  level: "${TRAEFIK_LOG_LEVEL}"
  filePath: "/var/log/traefik/traefik.log"
  format: json

accessLog:
  filePath: "/var/log/traefik/access.log"
  format: json
  bufferingSize: 100
  fields:
    headers:
      defaultMode: drop
      names:
        X-Request-Id: keep

certificatesResolvers:
  le-staging:
    acme:
      email: "${TRAEFIK_CERT_EMAIL}"
      storage: /etc/traefik/acme/acme-staging.json
      caServer: https://acme-staging-v02.api.letsencrypt.org/directory
      tlsChallenge: {}

providers:
  # Source of truth is file provider (dynamic.yml).
  file:
    filename: /etc/traefik/dynamic/dynamic.yml
    watch: true

  # Docker provider intentionally disabled to avoid label/file drift.
  # docker:
  #   endpoint: "unix:///var/run/docker.sock"
  #   exposedByDefault: ${TRAEFIK_EXPOSED_BY_DEFAULT}
  #   network: "${TRAEFIK_DOCKER_NETWORK}"
  #   watch: true
