# ============================================
# ENV Configuration
# ============================================

# Docker Compose Environment Variables
# Copy this file to .env and customize the values as needed
PROJECT_NAME=base2

# Application environment: development | staging | production
ENV=development

WEBSITE_DOMAIN=your_website_domain_here.com

DEPLOY_PATH=/opt/apps/

# ============================================
# Network Configuration
# ============================================
COMPOSE_PROJECT_NAME=base2
NETWORK_NAME=base2_network

# ============================================
# Celery Configuration
# ============================================
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1
CELERY_LOG_LEVEL=INFO
CELERY_CONCURRENCY=2

# ============================================
# Django Configuration
# ============================================
DJANGO_PYTHON_VERSION=3.12-slim
DJANGO_SECRET_KEY=change_me_long_random_string
DJANGO_DEBUG=false
DJANGO_ALLOWED_HOSTS=${WEBSITE_DOMAIN},admin.${WEBSITE_DOMAIN},django,api
DJANGO_PORT=8000
# Django superuser bootstrap (created at container start)
DJANGO_SUPERUSER_NAME=your_username_here
DJANGO_SUPERUSER_PASSWORD=your
DJANGO_SUPERUSER_EMAIL=your_email_here
DJANGO_ALLOW_ALL_HOSTS=true
DJANGO_SECURE_SSL_REDIRECT=false
# Django admin label (router host prefix)
DJANGO_ADMIN_DNS_LABEL=admin
DJANGO_ADMIN_ALLOWLIST=your_ip_address_here/32

# ============================================
# FastAPI Configuration
# ============================================
FASTAPI_PYTHON_VERSION=3.12-slim
FASTAPI_PORT=5001

# ============================================
# Flower Configuration
# ============================================
# Flower dashboard
FLOWER_DNS_LABEL=flower
# Escape $ as $$ in htpasswd format to avoid Compose interpolation warnings
FLOWER_BASIC_USERS=username:bcrypt_hash_here
FLOWER_ALLOWLIST=your_ip_address_here/32

# ============================================
# Nginx Configuration
# ============================================
NGINX_VERSION=1.25-alpine
NGINX_PORT=80
NGINX_HOST_PORT=8080
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024

# ============================================
# PostgreSQL Configuration
# ============================================
POSTGRES_VERSION=16-alpine
POSTGRES_USER=myuser
POSTGRES_PASSWORD=mypassword
POSTGRES_DB=mydatabase
POSTGRES_PORT=5432
POSTGRES_HOST_PORT=5432
DB_HOST=postgres
DB_USER=myuser
DB_PASSWORD=mypassword
# Legacy alias (some older scripts may still reference DB_PASS)
DB_PASS=mypassword

# ============================================
# pgAdmin Configuration
# ============================================
PGADMIN_VERSION=latest
PGADMIN_DEFAULT_EMAIL=admin@admin.com
PGADMIN_DEFAULT_PASSWORD=admin
PGADMIN_PORT=8080
PGADMIN_HOST_PORT=5050
PGADMIN_CONFIG_SERVER_MODE=True
PGADMIN_DNS_LABEL=pgadmin
PGADMIN_ALLOWLIST=your_ip_address_here/32

# ============================================
# React App Configuration
# ============================================
REACT_APP_NODE_VERSION=18-alpine
REACT_APP_PORT=3000
REACT_APP_HOST_PORT=3000
REACT_APP_API_URL=https://${WEBSITE_DOMAIN}/api

# ============================================
# Redis Configuration
# ============================================
REDIS_VERSION=7.2-alpine
REDIS_PORT=6379

# ============================================
# Traefik Configuration
# ============================================
TRAEFIK_VERSION=v3.1
TRAEFIK_PORT=80
TRAEFIK_API_PORT=8082
TRAEFIK_API_ENTRYPOINT=traefik
TRAEFIK_LOG_LEVEL=INFO
TRAEFIK_DOCKER_NETWORK=base2_network
TRAEFIK_API_DEBUG=false
TRAEFIK_CERT_EMAIL=your_email_here
TRAEFIK_EXPOSED_BY_DEFAULT=false
TRAEFIK_DNS_LABEL=traefik

# Traefik dashboard basic-auth users (htpasswd format: username:hash)
# Example: admin:bcrypt_hash_here. Generate with Node: node -e "p=require('bcrypt');p.hash('YourPassword',5).then(h=>console.log('admin:'+h))"
# Note: double each '$' to prevent Compose from misinterpreting bcrypt parts as variables.
TRAEFIK_DASH_BASIC_USERS=username:bcrypt_hash_here

# Traefik security headers preset (use no-HSTS for staging certs)
SECURITY_HEADERS_MIDDLEWARE=security-headers-no-hsts

# JWT Configuration (CHANGE IN PRODUCTION!)
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production_make_it_very_long_and_random
# Access-token TTL in minutes
JWT_EXPIRE=15

# Refresh token TTL in days
REFRESH_TOKEN_TTL_DAYS=30

# Token hashing pepper (separate from JWT secret; required in production)
TOKEN_PEPPER=change_me_long_random_string

# If true, refresh token is set as an httpOnly cookie; if false, refresh token is returned in JSON.
AUTH_REFRESH_COOKIE=true

# Email Configuration (SMTP)
# If EMAIL_HOST is empty, Django will fall back to writing emails to the EmailOutbox table.
EMAIL_HOST=
EMAIL_PORT=587
# Supported aliases:
# - EMAIL_HOST_USER / EMAIL_HOST_PASSWORD (Django)
# - EMAIL_USER / EMAIL_PASSWORD (legacy)
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
EMAIL_USER=
EMAIL_PASSWORD=
# Supported aliases:
# - DEFAULT_FROM_EMAIL (Django)
# - EMAIL_FROM (legacy)
DEFAULT_FROM_EMAIL=noreply@base2.com
EMAIL_FROM=noreply@base2.com

# ============================================
# Digital Ocean Configuration
# ============================================
# Reference: https://docs.digitalocean.com/reference/api/api-reference/
# See digital_ocean/README.md and quickstart.md for onboarding and usage details.
# WARNING: Never commit real secrets to version control!

# === Git Repo to pull from ===
DO_GIT_REPO=https://github.com/your_github_repo_here   # Git repo to deploy from (App Platform)

# === Core Authentication ===
DO_API_TOKEN=your_digital_ocean_api_token_here # REQUIRED. Personal access token from Digital Ocean dashboard.

# === Resource Defaults ===
DO_DOMAIN=${WEBSITE_DOMAIN}          # REQUIRED. Domain name for DNS automation (e.g., example.com)
DO_API_REGION=nyc3             # REQUIRED. Default region for resources (e.g., nyc3, sfo2)
DO_API_IMAGE=docker-20-04      # REQUIRED. Default image slug for Droplets/Apps
DO_API_SIZE=s-1vcpu-2gb        # REQUIRED. Default size slug for Droplets
DO_SSH_KEY_ID=your_digital_ocean_ssh_key_fingerprint_here      # REQUIRED. Droplets. SSH key ID or fingerprint for Droplets.         
DO_API_SSH_KEYS=your_digital_ocean_ssh_key_fingerprint_here # OPTIONAL. Comma-separated SSH key fingerprints or IDs for Apps.
DO_APP_NAME=base2-app          # REQUIRED. Name for deployed app
DO_REGISTRY_NAME=base2-registry # OPTIONAL. Name of container registry
DO_APP_SPEC_PATH=digital_ocean/app_spec.yaml # OPTIONAL. Path to app spec JSON/YAML for Apps API
DO_BACKUPS_ENABLED=false       # OPTIONAL. Enable backups for Droplets (true/false)
DO_IPV6_ENABLED=true           # OPTIONAL. Enable IPv6 for Droplets (true/false)
DO_USER_DATA_PATH=             # OPTIONAL. Path to cloud-init/user-data script (for Droplets)

# === Droplets API ===
DO_DROPLET_NAME=${PROJECT_NAME}-droplet  # OPTIONAL. Droplet name
DO_DROPLET_SIZE=s-1vcpu-1gb    # OPTIONAL. Droplet size slug
DO_DROPLET_IMAGE=docker-20-04  # OPTIONAL. Droplet image slug
DO_DROPLET_COUNT=1             # OPTIONAL. Number of Droplets to create
DO_DROPLET_PRIVATE_NETWORKING=true # OPTIONAL. Enable private networking (true/false)
DO_DROPLET_VOLUME_ID=          # OPTIONAL. Block storage volume ID to attach

# === Container Registry ===
DO_REPOSITORY_NAME=            # OPTIONAL. Repository name in registry
DO_IMAGE_TAG=latest            # OPTIONAL. Docker image tag

# === Spaces (S3-Compatible Storage) ===
DO_SPACES_KEY=                 # OPTIONAL. Spaces access key
DO_SPACES_SECRET=              # OPTIONAL. Spaces secret key
DO_SPACES_REGION=nyc3          # OPTIONAL. Region for Spaces

# === OAuth (Advanced Integrations) ===
DO_OAUTH_CLIENT_ID=            # OPTIONAL. OAuth client ID
DO_OAUTH_CLIENT_SECRET=        # OPTIONAL. OAuth client secret

# === Script/Operation Settings ===
DO_DEPLOY_TIMEOUT=300          # OPTIONAL. Timeout for deployment operations (seconds)
DO_TEARDOWN_TIMEOUT=120        # OPTIONAL. Timeout for teardown operations (seconds)
DO_LOG_LEVEL=INFO              # OPTIONAL. Logging verbosity (INFO, DEBUG, ERROR)
DO_API_RETRY_LIMIT=3           # OPTIONAL. Max retries for API rate limits/errors
DO_API_RETRY_DELAY=5           # OPTIONAL. Delay between retries (seconds)
DO_APP_ENV_EXAMPLE=VALUE       # OPTIONAL. Example custom app environment variable

# === Advanced/Production Variables ===
DO_PROJECT_ID=                 # OPTIONAL. Digital Ocean project ID
DO_FIREWALL_ID=                # OPTIONAL. Firewall ID to attach to Droplets/Apps
DO_VPC_UUID=                   # OPTIONAL. VPC UUID for custom networking
DO_TAGS=base2,automation       # OPTIONAL. Comma-separated tags for resource organization
DO_MONITORING_ENABLED=true     # OPTIONAL. Enable Digital Ocean monitoring (true/false)
DO_ALERT_EMAIL=                # OPTIONAL. Email for alerts/notifications
DO_APP_DOMAIN=                 # OPTIONAL. Custom domain for deployed app
DO_APP_BRANCH=your_github_branch_here
DO_APP_REPO_URL=               # OPTIONAL. Source repo URL
DO_APP_AUTOSCALE=false         # OPTIONAL. Enable autoscaling for Apps (true/false)
DO_APP_MIN_INSTANCES=1         # OPTIONAL. Autoscale minimum instances
DO_APP_MAX_INSTANCES=3         # OPTIONAL. Autoscale maximum instances
DO_API_TIMEOUT=60              # OPTIONAL. Global API timeout (seconds)
DO_API_BASE_URL=https://api.digitalocean.com/v2 # OPTIONAL. Override API base URL

# === Orchestrator Git Remote (for --update-only pulls) ===
GIT_REMOTE=https://github.com/your_github_repo_here
# === Health Checks & Observability ===
DO_APP_HEALTHCHECK_PATH=/health # OPTIONAL. Healthcheck endpoint for Apps
DO_APP_HEALTHCHECK_INTERVAL=30  # OPTIONAL. Healthcheck interval (seconds)
DO_APP_HEALTHCHECK_TIMEOUT=10   # OPTIONAL. Healthcheck timeout (seconds)
DO_APP_HEALTHCHECK_THRESHOLD=3  # OPTIONAL. Failure threshold before alert/rollback

# Frontend URL for email verification links
FRONTEND_URL=https://${WEBSITE_DOMAIN}

# Seed data (dev/demo)
SEED_ADMIN_EMAIL=admin@base2.local
SEED_ADMIN_PASSWORD=change_me_long_random_string
SEED_DEMO_PASSWORD=change_me_long_random_string

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100


# Auth & Security (required for cookie auth + CSRF)
# ============================================
SESSION_COOKIE_NAME=base2_session
CSRF_COOKIE_NAME=base2_csrf
COOKIE_SAMESITE=Lax
COOKIE_SECURE=true
DJANGO_INTERNAL_BASE_URL=http://django:8000
RATE_LIMIT_REDIS_PREFIX=rate_limit

# Google OAuth (Authorization Code flow)
GOOGLE_OAUTH_CLIENT_ID=your_google_client_id
GOOGLE_OAUTH_CLIENT_SECRET=your_google_client_secret
GOOGLE_OAUTH_REDIRECT_URI=https://${WEBSITE_DOMAIN}/oauth/google/callback
OAUTH_STATE_SECRET=change_me_long_random_string


